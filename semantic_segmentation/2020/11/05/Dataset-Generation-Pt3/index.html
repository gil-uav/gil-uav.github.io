<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="GPS-Independent Localization for UAVs">
	<meta property="og:title" content="Dataset generation pt. 3" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://gil-uav.github.io////semantic_segmentation/2020/11/05/Dataset-Generation-Pt3/" />
<meta property="og:image" content="https://gil-uav.github.io///img/home-bg-2.jpg">
	
	

	<meta name="citation_title" content="Project Pages - An Integrated Scientific Blogging Template">


<meta name="citation_author" content="Vegard Bergsvik Øvstegård">



	

	<link rel='shortcut icon' type='image/png' href='/favicon.png' />

    <title>Dataset generation pt. 3 - GIL-UAV</title>

    <link rel="canonical" href="https://gil-uav.github.io//semantic_segmentation/2020/11/05/Dataset-Generation-Pt3/">
	
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="https://gil-uav.github.io//css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://gil-uav.github.io//css/clean-blog.css">
	
	<!-- Adjust Colors -->
    <link rel="stylesheet" href="https://gil-uav.github.io//colorscheme.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="https://gil-uav.github.io//css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<!-- Math Jax -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script type="text/javascript"
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		TeX: { equationNumbers: { autoNumber: "AMS" } }
	});
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
	<script src="https://gil-uav.github.io//js/clean-blog.min.js "></script>
	
	
<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-100795269-2', 'auto');
  ga('send', 'pageview');

</script>

	
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
</script>
</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">GIL-UAV</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
				
                <li>
                    <a href="/projects/mcl/">Monte Carlo Localization</a>
                </li>
                
                <li>
                    <a href="/projects/semantic_segmentation/">Semantic segmentation</a>
                </li>
                
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
                <li>
                    <a href="/search/">Search</a>
                </li>
                
                <li>
                    <a href="/members/">Members</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/home-bg-2.jpg');">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="padding: 30px 0">
                    <h1>Dataset generation pt. 3</h1>
                    
                    <h2 class="subheading">Using QGIS to get ground truth-images.</h2>
                    
                    <span class="meta">Posted by Vegard Bergsvik Øvstegård on November 5, 2020</span>	
                </div>
            </div>
        </div>
    </div>
</header>






	
	
	
	<div class="float-left">
	<div class="recentpost" style="padding: 10px">
	
	<h4> Recently by the same author: </h4> 
	
	<hr class="style-one">
	
	<a href="/mcl/2020/11/23/MCL-Background/"><h2 class="post-title"> Monte Carlo Localization Background</h2></a>
	
	
		<h4 class="post-subtitle">This post contains an overview and description of former work and terminology related to Monte Carlo Localization.</h4>
	
	
	<p class="post-meta" style="margin-top: 5px;margin-bottom:5px; font-size: 0.8em">Posted by Vegard Bergsvik Øvstegård on November 23, 2020</p>
	
	<div class="notepad-index-post-tags" style="">
	<a href="/search/index.html#Localization" title="Other posts from the Localization tag">Localization</a>
	</div> 
	
			
 

<hr class="style-one">

	<img src="/img/profile.jpg" style="margin-top:0px; margin-bottom:5px; margin:auto; width:120px !important; border-radius: 50%;">
	
	<h3>Vegard Bergsvik Øvstegård</h3>
	
	<h4>Master Student at University of Oslo's Department of Informatics</h4>
	
	 
	<a href="https://github.com/vegovs" title="Github"><img src="/img/icons/github-icon.png " style="height:50px; float:right; margin-bot:10px"></a>
	
	
	
	<a href="https://ovstegard.no/" title="Google Plus"><img src="/img/icons/url-icon.png " style="height:33px; float:right; margin-top:9px;  margin-right: 10px"></a>
	
	


	
	</div>
	</div>
	
	
	
	
		
	

<!-- Also Interesting -->



	
	
	

	
	 
	
	
			
		
			
		
	
	
	

	
	 
	
	
		 
		
		<div class="float-right">
		<div class="relevantpost" style="padding: 10px">
		
		
		<h4> You may find interesting: </h4> 
		
		<hr class="style-one">
		
		<a href="/semantic_segmentation/2020/11/11/Dataset-V2/"><h2 class="post-title"> The dataset v0.1.0</h2></a>
		
		
			<h4 class="post-subtitle">Results from dataset v0.0.1 and a bump to v0.1.0</h4>
		
		
		<p class="post-meta" style="margin-top: 5px;margin-bottom:5px; font-size: 0.8em">Posted by Vegard Bergsvik Øvstegård on November 11, 2020</p>
		
		<div class="notepad-index-post-tags" style="">
		<a href="/search/index.html#post" title="Other posts from the Post tag">Post</a>&nbsp;<a href="/search/index.html#machine-learning" title="Other posts from the Machine-learning tag">Machine-learning</a>
		</div> 
		
		
		
		
	
			
		
		 
		
		<hr class="style-one">
		
		<a href="/semantic_segmentation/2020/11/11/Dataset-V2/"><h2 class="post-title"> The dataset v0.1.0</h2></a>
		
		
			<h4 class="post-subtitle">Results from dataset v0.0.1 and a bump to v0.1.0</h4>
		
		
		<p class="post-meta" style="margin-top: 5px;margin-bottom:5px; font-size: 0.8em">Posted by Vegard Bergsvik Øvstegård on November 11, 2020</p>
		
		<div class="notepad-index-post-tags" style="">
		<a href="/search/index.html#post" title="Other posts from the Post tag">Post</a>&nbsp;<a href="/search/index.html#machine-learning" title="Other posts from the Machine-learning tag">Machine-learning</a>
		</div> 
		
		
		
		
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
			
		
			
		
	
	
	

	
	 
	
	
			
		
			
		
	
	
	


		</div>
		</div>

<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>

<article>
    <div id="content" class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>
In order to extract the ground truth (GT) images from the vector maps recieved by <a href="https://www.kartverket.no/">Kartverket</a>. I used <a href="https://qgis.org/en/site/">QGIS</a>, an open source geographic information system. It was how-ever quite tedious to to extract the GT images manually using the GUI. So i wrote some simple <a href="https://github.com/gil-uav/orthophoto-dataset-generator/blob/master/qgis.py">python functions</a> to help me automate it. To put it short, the functions import all the orthophoto maps as layers to QGIS, and exports the images with the same spatial extent said orthophotos, but from the GT vector maps.
</p>
<h3 id="map-issues">
Map issues
</h3>
<p>
I did discover some issues while inspecting the GT vector maps and the orthophotos:
</p>
<p>
<strong>1.</strong> Rectification of orthophotos was not perfect, some buildings were not completely segmented. <img src="/img/rect_seg_issue.png" alt="Segmentation issue due to Rectification" /> <strong>2.</strong> Not all buildings where segmented.<img src="/img/missing_building_seg.png" alt="Missing building segmentation." /> <strong>3.</strong> Water segmentation of rivers where highly inaccurate, this is due to the riverbed naturally shifting.<img src="/img/bad_river_seg.png" alt="Inaccurate river segmentation" />
</p>
<p>
To solve issue <strong>1</strong>, i used QGIS to adjust the GT vector layer a bit. I simply widened the vector by one meter at scale. The only way to solve issue number <strong>2</strong> and <strong>3</strong> is either with manual adjustment of the vector maps, or simply scrubbing the dataset after creation. Both tedious jobs, but they might be worth while. An idea to automate the scrubbing for issue number <strong>2</strong>. is to train the network on the dataset, and then use the network identify and remove sets with non-segmented buildings. These fixes will be considered after the first training runs.
</p>
<h3 id="qgis-helper-functions">
QGIS helper functions:
</h3>
<div id="cb1" class="sourceCode">
<pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="im">import</span> os</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="im">from</span> qgis.core <span class="im">import</span> QgsProject</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="im">from</span> glob <span class="im">import</span> glob</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">project <span class="op">=</span> QgsProject.instance()</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">root <span class="op">=</span> QgsProject.instance().layerTreeRoot()</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">def</span> import_map(path_to_tif: <span class="bu">str</span>, root):</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">    Imports a .tif file as map-layer.</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">    path_to_tif : str</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">        Path to .tif file.</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">    root</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">        Project instance layer root.</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    rlayer <span class="op">=</span> QgsRasterLayer(</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">        path_to_tif, os.path.basename(path_to_tif).replace(<span class="st">&quot;.tif&quot;</span>, <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">    )</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">    <span class="cf">if</span> <span class="kw">not</span> rlayer.isValid():</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">        <span class="bu">print</span>(<span class="st">&quot;Layer failed to load!&quot;</span>)</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">    iface.addRasterLayer(path_to_tif, os.path.basename(path_to_tif).replace(<span class="st">&quot;.tif&quot;</span>, <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="kw">def</span> import_all_maps(path):</a>
<a class="sourceLine" id="cb1-35" data-line-number="35">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">    Imports all .tif files to project as layers.</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">    path : str</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">        Path to folder containing .tif files(Ortophotos)</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46">    maps <span class="op">=</span> [y <span class="cf">for</span> x <span class="kw">in</span> os.walk(path) <span class="cf">for</span> y <span class="kw">in</span> glob(os.path.join(x[<span class="dv">0</span>], <span class="st">&quot;*.tif&quot;</span>))]</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">    <span class="cf">for</span> m <span class="kw">in</span> ops:</a>
<a class="sourceLine" id="cb1-48" data-line-number="48">        import_map(m, root)</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">        <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st"> imported.&quot;</span>.<span class="bu">format</span>(os.path.basename(m)))</a>
<a class="sourceLine" id="cb1-50" data-line-number="50"></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="kw">def</span> get_ortophoto_layers():</a>
<a class="sourceLine" id="cb1-53" data-line-number="53">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="co">    Returns all ortophoto layers from project.</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="co">    layers : list</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="co">        List of ortophoto layers.</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59"></a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61">    layers <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1-62" data-line-number="62">        l</a>
<a class="sourceLine" id="cb1-63" data-line-number="63">        <span class="cf">for</span> l <span class="kw">in</span> QgsProject.instance().mapLayers().values()</a>
<a class="sourceLine" id="cb1-64" data-line-number="64">        <span class="cf">if</span> l.name().startswith(<span class="st">&quot;33&quot;</span>)</a>
<a class="sourceLine" id="cb1-65" data-line-number="65">    ]</a>
<a class="sourceLine" id="cb1-66" data-line-number="66">    layers <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1-67" data-line-number="67">        l</a>
<a class="sourceLine" id="cb1-68" data-line-number="68">        <span class="cf">for</span> l <span class="kw">in</span> QgsProject.instance().mapLayers().values()</a>
<a class="sourceLine" id="cb1-69" data-line-number="69">        <span class="cf">if</span> l.<span class="bu">type</span>() <span class="op">==</span> QgsMapLayer.RasterLayer</a>
<a class="sourceLine" id="cb1-70" data-line-number="70">    ]</a>
<a class="sourceLine" id="cb1-71" data-line-number="71">    <span class="cf">return</span> layers</a>
<a class="sourceLine" id="cb1-72" data-line-number="72"></a>
<a class="sourceLine" id="cb1-73" data-line-number="73"></a>
<a class="sourceLine" id="cb1-74" data-line-number="74"><span class="kw">def</span> export_basedata_as_img(layer, export_path: <span class="bu">str</span>):</a>
<a class="sourceLine" id="cb1-75" data-line-number="75">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76"><span class="co">    Saves ground-truth for layer as .png file.</span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77"></a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80"><span class="co">    export_path : str</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81"><span class="co">        Where to save the image.</span></a>
<a class="sourceLine" id="cb1-82" data-line-number="82"><span class="co">    layer</span></a>
<a class="sourceLine" id="cb1-83" data-line-number="83"><span class="co">        Orthophoto layer to produce ground-truth map from.</span></a>
<a class="sourceLine" id="cb1-84" data-line-number="84"></a>
<a class="sourceLine" id="cb1-85" data-line-number="85"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-86" data-line-number="86">    outfile <span class="op">=</span> os.path.join(export_path, <span class="st">&quot;</span><span class="sc">{}</span><span class="st">_y.png&quot;</span>.<span class="bu">format</span>(layer.name()))</a>
<a class="sourceLine" id="cb1-87" data-line-number="87"></a>
<a class="sourceLine" id="cb1-88" data-line-number="88">    settings <span class="op">=</span> QgsMapSettings()</a>
<a class="sourceLine" id="cb1-89" data-line-number="89">    settings.setLayers(</a>
<a class="sourceLine" id="cb1-90" data-line-number="90">        [</a>
<a class="sourceLine" id="cb1-91" data-line-number="91">            QgsProject.instance().mapLayersByName(<span class="st">&quot;fkb_bygning_omrade&quot;</span>)[<span class="dv">0</span>],</a>
<a class="sourceLine" id="cb1-92" data-line-number="92">            QgsProject.instance().mapLayersByName(<span class="st">&quot;fkb_vann_omrade&quot;</span>)[<span class="dv">0</span>],</a>
<a class="sourceLine" id="cb1-93" data-line-number="93">        ]</a>
<a class="sourceLine" id="cb1-94" data-line-number="94">    )</a>
<a class="sourceLine" id="cb1-95" data-line-number="95">    settings.setBackgroundColor(QColor(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1-96" data-line-number="96">    settings.setOutputSize(QSize(layer.width(), layer.height()))</a>
<a class="sourceLine" id="cb1-97" data-line-number="97">    settings.setExtent(layer.extent())</a>
<a class="sourceLine" id="cb1-98" data-line-number="98">    render <span class="op">=</span> QgsMapRendererParallelJob(settings)</a>
<a class="sourceLine" id="cb1-99" data-line-number="99"></a>
<a class="sourceLine" id="cb1-100" data-line-number="100">    <span class="kw">def</span> finished():</a>
<a class="sourceLine" id="cb1-101" data-line-number="101">        img <span class="op">=</span> render.renderedImage()</a>
<a class="sourceLine" id="cb1-102" data-line-number="102">        img.save(outfile, <span class="st">&quot;png&quot;</span>)</a>
<a class="sourceLine" id="cb1-103" data-line-number="103"></a>
<a class="sourceLine" id="cb1-104" data-line-number="104">    render.finished.<span class="ex">connect</span>(finished)</a>
<a class="sourceLine" id="cb1-105" data-line-number="105">    render.start()</a>
<a class="sourceLine" id="cb1-106" data-line-number="106">    <span class="bu">print</span>(<span class="st">&quot;Ground truth image export of </span><span class="sc">{}</span><span class="st"> started.&quot;</span>.<span class="bu">format</span>(layer.name()))</a>
<a class="sourceLine" id="cb1-107" data-line-number="107">    <span class="im">from</span> qgis.PyQt.QtCore <span class="im">import</span> QEventLoop</a>
<a class="sourceLine" id="cb1-108" data-line-number="108"></a>
<a class="sourceLine" id="cb1-109" data-line-number="109">    loop <span class="op">=</span> QEventLoop()</a>
<a class="sourceLine" id="cb1-110" data-line-number="110">    render.finished.<span class="ex">connect</span>(loop.quit)</a>
<a class="sourceLine" id="cb1-111" data-line-number="111">    loop.exec_()</a>
<a class="sourceLine" id="cb1-112" data-line-number="112">    <span class="bu">print</span>(<span class="st">&quot;Ground truth image of </span><span class="sc">{}</span><span class="st"> exported to: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(layer.name(), outfile))</a>
<a class="sourceLine" id="cb1-113" data-line-number="113"></a>
<a class="sourceLine" id="cb1-114" data-line-number="114"></a>
<a class="sourceLine" id="cb1-115" data-line-number="115"><span class="kw">def</span> export_all_ground_truth_maps(export_path: <span class="bu">str</span>):</a>
<a class="sourceLine" id="cb1-116" data-line-number="116">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-117" data-line-number="117"><span class="co">    Exports ground truth images of all orthophoto layers.</span></a>
<a class="sourceLine" id="cb1-118" data-line-number="118"></a>
<a class="sourceLine" id="cb1-119" data-line-number="119"><span class="co">    export_path : str</span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120"><span class="co">        Where to save the image.</span></a>
<a class="sourceLine" id="cb1-121" data-line-number="121"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-122" data-line-number="122">    <span class="cf">for</span> l <span class="kw">in</span> get_ortophoto_layers():</a>
<a class="sourceLine" id="cb1-123" data-line-number="123">        export_basedata_as_img(l, export_path)</a></code></pre>
</div>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/semantic_segmentation/2020/10/30/Dataset-Generation-Pt2/" data-toggle="tooltip" data-placement="top" title="Dataset generation pt. 2">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/semantic_segmentation/2020/11/09/Dataset-V1/" data-toggle="tooltip" data-placement="top" title="The dataset v0.0.1">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>

<div class="container" style="padding-right: 50px;padding-left: 50px;">
<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" id="disqus_thread">

</div>
</div>
</div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = '';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


<hr>


	
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/gil-uav/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
									
                </ul>
            </div>
        </div>
    </div>
</footer>



</body>

</html>
